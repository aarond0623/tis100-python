@1
## SEQUENCE PEAK DETECTOR
MOV UP ACC
MOV ACC DOWN
MOV ACC RIGHT

@2
MOV -999 ACC
START:
  SAV
  MOV LEFT ACC
  JEZ END
  MOV ACC RIGHT
  SWP
  MOV ACC RIGHT
  MOV ACC RIGHT
  MOV RIGHT ACC
  JMP START
END:
  SWP
  MOV ACC DOWN

@3
MOV LEFT ACC
SAV
SUB LEFT
JGZ NEWMAX
MOV LEFT LEFT
JRO -5
NEWMAX:
  SWP
  MOV LEFT NIL
  MOV ACC LEFT

@4
MOV RIGHT ACC
SAV
SUB RIGHT
JLZ NEWMIN
MOV RIGHT RIGHT
JRO -5
NEWMIN:
  SWP
  MOV RIGHT NIL
  MOV ACC RIGHT

@5
MOV 999 ACC
START:
  SAV
  MOV UP ACC
  JEZ END
  MOV ACC LEFT
  SWP
  MOV ACC LEFT
  MOV ACC LEFT
  MOV LEFT ACC
  JMP START
END:
  SWP
  MOV ACC DOWN

@6
MOV UP DOWN

@8
MOV UP DOWN

@9
MOV UP DOWN
